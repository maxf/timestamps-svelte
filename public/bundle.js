!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function a(t){t.forEach(e)}function s(t){return"function"==typeof t}function p(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(t,e){t.appendChild(e)}function o(t,e,n){t.insertBefore(e,n||null)}function i(t){t.parentNode.removeChild(t)}function m(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function c(t){return document.createElement(t)}function l(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function u(t){return document.createTextNode(t)}function d(){return u(" ")}function f(t,e,n,a){return t.addEventListener(e,n,a),()=>t.removeEventListener(e,n,a)}function h(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function g(t,e){e=""+e,t.data!==e&&(t.data=e)}let w;function S(t){w=t}function v(t){(function(){if(!w)throw new Error("Function called outside component initialization");return w})().$$.on_mount.push(t)}const $=[],T=[],b=[],y=[],_=Promise.resolve();let x=!1;function z(t){b.push(t)}function M(){const t=new Set;do{for(;$.length;){const t=$.shift();S(t),O(t.$$)}for(;T.length;)T.pop()();for(;b.length;){const e=b.pop();t.has(e)||(e(),t.add(e))}}while($.length);for(;y.length;)y.pop()();x=!1}function O(t){t.fragment&&(t.update(t.dirty),a(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(z))}const k=new Set;const N="undefined"!=typeof window?window:global;function C(t,e){t.$$.dirty||($.push(t),x||(x=!0,_.then(M)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function E(p,r,o,i,m,c){const l=w;S(p);const u=r.props||{},d=p.$$={fragment:null,ctx:null,props:c,update:t,not_equal:m,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(l?l.$$.context:[]),callbacks:n(),dirty:null};let f=!1;var h,g,v;d.ctx=o?o(p,u,(t,e)=>{d.ctx&&m(d.ctx[t],d.ctx[t]=e)&&(d.bound[t]&&d.bound[t](e),f&&C(p,t))}):u,d.update(),f=!0,a(d.before_render),d.fragment=i(d.ctx),r.target&&(r.hydrate?d.fragment.l((v=r.target,Array.from(v.childNodes))):d.fragment.c(),r.intro&&((h=p.$$.fragment)&&h.i&&(k.delete(h),h.i(g))),function(t,n,p){const{fragment:r,on_mount:o,on_destroy:i,after_render:m}=t.$$;r.m(n,p),z(()=>{const n=o.map(e).filter(s);i?i.push(...n):a(n),t.$$.on_mount=[]}),m.forEach(z)}(p,r.target,r.anchor),M()),S(l)}class B{$destroy(){var e,n;n=1,(e=this).$$.fragment&&(a(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={}),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const{Object:j}=N;function A(t,e,n){const a=j.create(t);return a.t=e[n],a}function D(t,e,n){const a=j.create(t);return a.t=e[n],a}function I(t){var e,n,s,p,m,l,g,w,S,v,$,T,b,y,_=t.appState.errorMessage&&J(t);return{c(){(e=c("button")).textContent="Add",n=d(),(s=c("button")).textContent="Cancel",p=d(),_&&_.c(),m=d(),l=c("div"),g=c("input"),w=u("/"),S=c("input"),v=u("\n    @\n    "),$=c("input"),T=u(":"),b=c("input"),h(e,"class","big add svelte-1wzbdfc"),h(s,"class","big svelte-1wzbdfc"),h(g,"class","date-2 svelte-1wzbdfc"),h(g,"inputmode","numeric"),h(S,"class","date-2 svelte-1wzbdfc"),h(S,"inputmode","numeric"),h($,"class","date-2 svelte-1wzbdfc"),h($,"inputmode","numeric"),h(b,"class","date-2 svelte-1wzbdfc"),h(b,"inputmode","numeric"),h(l,"class","date-input svelte-1wzbdfc"),y=[f(e,"click",t.addTimestamp),f(s,"click",t.cancelAddTimestamp),f(g,"input",t.input0_input_handler),f(S,"input",t.input1_input_handler),f($,"input",t.input2_input_handler),f(b,"input",t.input3_input_handler)]},m(a,i){o(a,e,i),o(a,n,i),o(a,s,i),o(a,p,i),_&&_.m(a,i),o(a,m,i),o(a,l,i),r(l,g),g.value=t.appState.newTimestamp.date,r(l,w),r(l,S),S.value=t.appState.newTimestamp.month1,r(l,v),r(l,$),$.value=t.appState.newTimestamp.hours,r(l,T),r(l,b),b.value=t.appState.newTimestamp.minutes},p(t,e){e.appState.errorMessage?_?_.p(t,e):((_=J(e)).c(),_.m(m.parentNode,m)):_&&(_.d(1),_=null),t.appState&&g.value!==e.appState.newTimestamp.date&&(g.value=e.appState.newTimestamp.date),t.appState&&S.value!==e.appState.newTimestamp.month1&&(S.value=e.appState.newTimestamp.month1),t.appState&&$.value!==e.appState.newTimestamp.hours&&($.value=e.appState.newTimestamp.hours),t.appState&&b.value!==e.appState.newTimestamp.minutes&&(b.value=e.appState.newTimestamp.minutes)},d(t){t&&(i(e),i(n),i(s),i(p)),_&&_.d(t),t&&(i(m),i(l)),a(y)}}}function F(e){var n,a;return{c(){(n=c("button")).textContent="New",h(n,"class","big svelte-1wzbdfc"),a=f(n,"click",e.prepareNewTimestamp)},m(t,e){o(t,n,e)},p:t,d(t){t&&i(n),a()}}}function J(t){var e,n,a=t.appState.errorMessage;return{c(){e=c("div"),n=u(a),h(e,"class","error-message svelte-1wzbdfc")},m(t,a){o(t,e,a),r(e,n)},p(t,e){t.appState&&a!==(a=e.appState.errorMessage)&&g(n,a)},d(t){t&&i(e)}}}function R(t){for(var e,n,s,p,r,u,g,w,S,v=t.appState.timestamps.sort(Y),$=[],T=0;T<v.length;T+=1)$[T]=V(D(t,v,T));var b=t.appState.timestamps,y=[];for(T=0;T<b.length;T+=1)y[T]=H(A(t,b,T));return{c(){e=c("ul");for(var a=0;a<$.length;a+=1)$[a].c();n=d(),(s=c("button")).textContent="Copy",p=d(),(r=c("button")).textContent="Reset",u=d(),g=l("svg");for(a=0;a<y.length;a+=1)y[a].c();h(e,"class","ts-list svelte-1wzbdfc"),h(s,"class","small svelte-1wzbdfc"),h(r,"class","small svelte-1wzbdfc"),h(g,"viewBox",w=t.chartViewBox(t.appState.timestamps)),h(g,"preserveAspectRatio","none"),h(g,"width","100%"),h(g,"height","200px"),h(g,"class","svelte-1wzbdfc"),S=[f(s,"click",t.copy),f(r,"click",t.reset)]},m(t,a){o(t,e,a);for(var i=0;i<$.length;i+=1)$[i].m(e,null);o(t,n,a),o(t,s,a),o(t,p,a),o(t,r,a),o(t,u,a),o(t,g,a);for(i=0;i<y.length;i+=1)y[i].m(g,null)},p(t,n){if(t.formatTimestamp||t.appState){v=n.appState.timestamps.sort(Y);for(var a=0;a<v.length;a+=1){const s=D(n,v,a);$[a]?$[a].p(t,s):($[a]=V(s),$[a].c(),$[a].m(e,null))}for(;a<$.length;a+=1)$[a].d(1);$.length=v.length}if(t.dayOfTimestamp||t.appState||t.timeOfTimestamp){b=n.appState.timestamps;for(a=0;a<b.length;a+=1){const e=A(n,b,a);y[a]?y[a].p(t,e):(y[a]=H(e),y[a].c(),y[a].m(g,null))}for(;a<y.length;a+=1)y[a].d(1);y.length=b.length}t.appState&&w!==(w=n.chartViewBox(n.appState.timestamps))&&h(g,"viewBox",w)},d(t){t&&i(e),m($,t),t&&(i(n),i(s),i(p),i(r),i(u),i(g)),m(y,t),a(S)}}}function V(t){var e,n,a,s,p,m,l=t.formatTimestamp(t.t);function w(){return t.click_handler(t)}return{c(){e=c("li"),n=u(l),a=d(),(s=c("button")).textContent="❌",p=d(),h(s,"class","del svelte-1wzbdfc"),h(e,"class","svelte-1wzbdfc"),m=f(s,"click",w)},m(t,i){o(t,e,i),r(e,n),r(e,a),r(e,s),r(e,p)},p(e,a){t=a,e.appState&&l!==(l=t.formatTimestamp(t.t))&&g(n,l)},d(t){t&&i(e),m()}}}function H(t){var e,n,a;return{c(){h(e=l("rect"),"x",n=t.dayOfTimestamp(t.t)),h(e,"y",a=t.timeOfTimestamp(t.t)/1e3),h(e,"width","1"),h(e,"height","1000"),h(e,"fill","red")},m(t,n){o(t,e,n)},p(t,s){t.appState&&n!==(n=s.dayOfTimestamp(s.t))&&h(e,"x",n),t.appState&&a!==(a=s.timeOfTimestamp(s.t)/1e3)&&h(e,"y",a)},d(t){t&&i(e)}}}function L(e){var n,a,s,p,m,l,f;function w(t){return t.appState.newTimestamp?I:F}var S=w(e),v=S(e),$=e.appState.timestamps.length&&R(e);return{c(){n=c("div"),a=c("h1"),s=c("img"),p=d(),m=u(e.name),l=d(),v.c(),f=d(),$&&$.c(),h(s,"src","clock-icon-192.png"),h(s,"alt","clock icon"),h(s,"height","20px"),h(a,"class","svelte-1wzbdfc"),h(n,"class","component svelte-1wzbdfc")},m(t,e){o(t,n,e),r(n,a),r(a,s),r(a,p),r(a,m),r(n,l),v.m(n,null),r(n,f),$&&$.m(n,null)},p(t,e){t.name&&g(m,e.name),S===(S=w(e))&&v?v.p(t,e):(v.d(1),(v=S(e))&&(v.c(),v.m(n,f))),e.appState.timestamps.length?$?$.p(t,e):(($=R(e)).c(),$.m(n,null)):$&&($.d(1),$=null)},i:t,o:t,d(t){t&&i(n),v.d(),$&&$.d()}}}function Y(t,e){return e-t}function q(t,e,n){let{name:a}=e;const s={timestamps:[],newTimestamp:null,errorMessage:null},p=(t,e)=>t.toString().padStart(e,"0"),r=t=>`${t.getDate()}/${t.getMonth()+1}/${p(t.getFullYear(),4)}`+", "+`${t.getHours()}:${p(t.getMinutes(),2)}`+"\n",o=()=>{const t=localStorage.getItem("timestamps");let e;try{e=JSON.parse(t)}catch(t){console.log("failed to parse localstorage json."),e=null}return(t=>!!t&&t.constructor===Object)(e)||(console.log("localstorage is not an object. Resetting to {}"),localStorage.setItem("timestamps","{}"),e={}),e},i=t=>{s.timestamps=s.timestamps.filter(e=>e!==t),n("appState",s)},m=t=>Math.floor(t/864e5);return v(()=>{s.timestamps=(t=>{const e=o();return e[t]?e[t].map(t=>new Date(Date.parse(t))):[]})(a),n("appState",s),s.newTimestamp=null,n("appState",s)}),t.$set=(t=>{"name"in t&&n("name",a=t.name)}),{name:a,appState:s,formatTimestamp:r,prepareNewTimestamp:()=>{var t=new Date;s.newTimestamp={date:t.getDate(),month1:t.getMonth()+1,year:t.getFullYear(),hours:t.getHours(),minutes:t.getMinutes()},n("appState",s)},addTimestamp:()=>{const t=s.newTimestamp,e=new Date(t.year,t.month1-1,t.date,t.hours,t.minutes);(t=>t instanceof Date&&!isNaN(t))(e)?(s.errorMessage=null,n("appState",s),s.timestamps.push(e),((t,e)=>{const n=o();n[t]=e,localStorage.setItem("timestamps",JSON.stringify(n))})(a,s.timestamps.sort((t,e)=>t-e)),s.newTimestamp=null,n("appState",s)):(s.errorMessage="Bad timestamp",n("appState",s))},deleteTimestamp:i,cancelAddTimestamp:()=>{const t=s.newTimestamp=null;return n("appState",s),t},reset:()=>{s.timestamps=[],n("appState",s),s.newTimestamp=null,n("appState",s),(t=>{const e=o();delete e[t],localStorage.setItem("timestamps",JSON.stringify(e))})(a)},copy:()=>{const t=s.timestamps.map(r).join("");navigator.clipboard.writeText(t)},dayOfTimestamp:m,timeOfTimestamp:t=>t-1e3*m(t)*3600*24,chartViewBox:t=>{const e=Math.min.apply(this,t),n=Math.max.apply(this,t),a=m(e);return`${a} 0 ${m(n)-a+1} 86400`},input0_input_handler:function(){s.newTimestamp.date=this.value,n("appState",s)},input1_input_handler:function(){s.newTimestamp.month1=this.value,n("appState",s)},input2_input_handler:function(){s.newTimestamp.hours=this.value,n("appState",s)},input3_input_handler:function(){s.newTimestamp.minutes=this.value,n("appState",s)},click_handler:function({t:t}){return i(t)}}}class P extends B{constructor(t){super(),E(this,t,q,L,p,["name"])}}new P({target:document.getElementById("ts1"),props:{name:"TS1"}}),new P({target:document.getElementById("ts2"),props:{name:"TS2"}})}();
//# sourceMappingURL=bundle.js.map
